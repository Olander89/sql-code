SELECT kf.Orgnr, kf.Namn, kf.Koncern, SUM(pp.ProvisionNetto) AS TotalProvision
FROM dw.kundforetag kf
LEFT JOIN dw.Prov_Provision pp ON kf.Orgnr = pp.ForsakringstagareOrgnr
RIGHT JOIN #Temp t ON kf.Orgnr = t.Orgnr
WHERE pp.Korning BETWEEN CONVERT(datetime,'2017-01-01') AND CONVERT(datetime,'2017-12-31 23:59:59:999')
GROUP BY kf.Orgnr, kf.Namn, kf.Koncern
ORDER BY TotalProvision DESC

SELECT kf.Orgnr, kf.Namn, kf.Koncern, SUM(pp.ProvisionNetto) AS TotalProvision
FROM dw.kundforetag kf
LEFT JOIN dw.Prov_Provision pp ON kf.Orgnr = pp.ForsakringstagareOrgnr
RIGHT JOIN #Temp t ON kf.Orgnr = t.Orgnr
WHERE pp.Korning BETWEEN CONVERT(datetime,'2018-01-01') AND CONVERT(datetime,'2018-12-31 23:59:59:999')
GROUP BY kf.Orgnr, kf.Namn, kf.Koncern
ORDER BY TotalProvision DESC


CREATE TABLE #Temp
(
Orgnr CHAR(10)
)

DROP TABLE #Temp

INSERT INTO #Temp (Orgnr)
VALUES
('5569323719'),
('5567402929'),
('5568251887'),
('5561972240'),
('5566825526'),
('5565191227'),
('5568883093'),
('5565787172'),
('5569639908'),
('5566523386'),
('5565755591'),
('5564214509'),
('5569902983'),
('5564483823'),
('5569244691'),
('5560371600'),
('5560350091'),
('5564297850'),
('5568033160'),
('5590114194'),
('5560971722'),
('5568819410'),
('5563373108'),
('5560936360'),
('5567638159'),
('5562291004'),
('5567988950'),
('5564705548'),
('5562597863'),
('5566150214'),
('5567319602'),
('5565086930'),
('5565166682'),
('5567539522'),
('5564143385'),
('5562761725'),
('5561427468'),
('5564718616'),
('5565192720'),
('5566643333'),
('5568816523'),
('5564580446'),
('5567454060'),
('5567151682'),
('5560368689'),
('5566693130'),
('5568336951'),
('5563177855'),
('5566652540'),
('5565519849'),
('5565855771'),
('5568247588'),
('5568913528'),
('5569584666'),
('5561871004'),
('5566483987'),
('5565875571'),
('5562974005'),
('5566852389'),
('5566502224'),
('5566871355'),
('5566815519'),
('5569514747'),
('5560634072'),
('5566890090'),
('5568204076'),
('5564306859'),
('5561667345'),
('5568901697'),
('5568620289'),
('5565681300'),
('5569627135'),
('5566764824'),
('5562145812'),
('5566865878'),
('5568911118'),
('5562133644'),
('5568607294'),
('5567250344'),
('5569732786'),
('5590049176'),
('5569443152'),
('5565372801'),
('5590140504'),
('5568884497'),
('5568255094'),
('5563410736'),
('5566862545'),
('5567913263'),
('5569053993'),
('5563207447'),
('5565780938'),
('5590200753'),
('5566825922'),
('5568462666'),
('5569205502'),
('5568446958'),
('5567022610'),
('5564586971'),
('5569969776'),
('5565996997'),
('5565209516'),
('5563117018'),
('5564482981'),
('5562847722'),
('5565536868'),
('5565013207'),
('5568056088'),
('5563342095'),
('5566188149'),
('5567318752'),
('5563807147'),
('5566367792'),
('5566829197'),
('5566820386'),
('5560603853'),
('5566240510'),
('5567104384'),
('5565114047'),
('5566625140'),
('5566146048'),
('5565720900'),
('5567914519'),
('5563523371'),
('5566418850'),
('5565425716'),
('5567716070'),
('5565865523'),
('5565192969'),
('5566511167'),
('5567434153'),
('5569027468'),
('5564491941'),
('5561436543'),
('5564253317'),
('5562793207'),
('5568136567'),
('5569208209'),
('5567666192'),
('5568143019'),
('5566228903'),
('5569587826'),
('5564913381'),
('5564458064'),
('5564274719'),
('5568761976'),
('5568223423'),
('5568009566'),
('5590244421'),
('5567901136'),
('5590193230'),
('5567279368'),
('5590668264'),
('5567456693'),
('5565640819'),
('5567615660'),
('5567034698'),
('5564775715'),
('5567502561'),
('5564414786'),
('5566318902'),
('5561302331'),
('5566514476'),
('5566410725'),
('5565622551'),
('5564331964'),
('5566434998'),
('5567155873'),
('5567627657'),
('5561614206'),
('5563732824'),
('5565778098'),
('5568468457'),
('5567510622'),
('5567189781'),
('5567917603'),
('5566980636'),
('5566740527'),
('5568937329'),
('5562773126'),
('5590045968'),
('5565940755'),
('5568215031'),
('5565389995'),
('5568542004'),
('5562140318'),
('5567000939'),
('5566727714'),
('5560764572'),
('5560663352'),
('5560639683'),
('5561114249'),
('5569228124'),
('5564968302'),
('5567107585'),
('5565700605'),
('5565179826'),
('5565260618'),
('5569909921'),
('5566114830'),
('5562598291'),
('5567956031'),
('5566014741'),
('5569386518'),
('5568192420'),
('5569313256'),
('5564371317'),
('5561822981'),
('5567559116'),
('5563750958'),
('5561500447'),
('5565714754'),
('5567523229'),
('5560172925'),
('5563450401'),
('5564335544'),
('5565915856'),
('5568874753'),
('5567354799'),
('5560348848'),
('5560477472'),
('5565720231'),
('5561636423'),
('5567626816'),
('5562942705'),
('5565768958'),
('5562952274'),
('5568548019'),
('5565990248'),
('5567239784'),
('5562767441'),
('5567690176'),
('5568457344'),
('5566263488'),
('5568445992'),
('5567336374'),
('5566504907'),
('5569147654'),
('5561078634'),
('5560663360'),
('5561024414'),
('5561371757'),
('5568420185')
