CREATE TABLE #Temp1
(
 Orgnr CHAR(10)
)

INSERT INTO #Temp1
(Orgnr)
VALUES

('2120001033'),
('2120001439'),
('4601145933'),
('4708265030'),
('5020105523'),
('5020449921'),
('5020618988'),
('5020687405'),
('5020721931'),
('5020728662'),
('5020734702'),
('5020757299'),
('5020776257'),
('5020777826'),
('5020794706'),
('5020809074'),
('5020809918'),
('5020810437'),
('5106031015'),
('5164021635'),
('5164021635'),
('5164023110'),
('5164025313'),
('5164026972'),
('5164027756'),
('5164038076'),
('5164043811'),
('5164060740'),
('5164060948'),
('5164061094'),
('5164073974'),
('5164088642'),
('5164096975'),
('5164102070'),
('5164108168'),
('5164110222'),
('5164111592'),
('5164111725'),
('5164114042'),
('5164114265'),
('5164115460'),
('5164116120'),
('5210261243'),
('5402197817'),
('5500000000'),
('5502032034'),
('5505307016'),
('5506189470'),
('5509085568'),
('5555555555'),
('5555555555'),
('5555555555'),
('5555555555'),
('5555555555'),
('5555555555'),
('5560007881'),
('5560016064'),
('5560018300'),
('5560027335'),
('5560068974'),
('5560075011'),
('5560078502'),
('5560079104'),
('5560121997'),
('5560124769'),
('5560129628'),
('5560145418'),
('5560148644'),
('5560163429'),
('5560170515'),
('5560172925'),
('5560179367'),
('5560196817'),
('5560201781'),
('5560212606'),
('5560215286'),
('5560221813'),
('5560252891'),
('5560273244'),
('5560292566'),
('5560299835'),
('5560353335'),
('5560372772'),
('5560414285'),
('5560421363'),
('5560432014'),
('5560435413'),
('5560457789'),
('5560469552'),
('5560471350'),
('5560493404'),
('5560499690'),
('5560502683'),
('5560502683'),
('5560514571'),
('5560531617'),
('5560537820'),
('5560555939'),
('5560556036'),
('5560567298'),
('5560572744'),
('5560574062'),
('5560594037'),
('5560606716'),
('5560627647'),
('5560628629'),
('5560630476'),
('5560637331'),
('5560637331'),
('5560645086'),
('5560665894'),
('5560674276'),
('5560689209'),
('5560694035'),
('5560698812'),
('5560704131'),
('5560704800'),
('5560712167'),
('5560717943'),
('5560722596'),
('5560725771'),
('5560732850'),
('5560752650'),
('5560764465'),
('5560803750'),
('5560804683'),
('5560820044'),
('5560862764'),
('5560877168'),
('5560882150'),
('5560892480'),
('5560906371'),
('5560909391'),
('5560910712'),
('5560932054'),
('5560943085'),
('5560953209'),
('5560954009'),
('5560984113'),
('5560986696'),
('5560997065'),
('5561010058'),
('5561019430'),
('5561031849'),
('5561034272'),
('5561047878'),
('5561058099'),
('5561063529'),
('5561070235'),
('5561079376'),
('5561113555'),
('5561122382'),
('5561124982'),
('5561130559'),
('5561135863'),
('5561142810'),
('5561179796'),
('5561190124'),
('5561224782'),
('5561226506'),
('5561229328'),
('5561247304'),
('5561274696'),
('5561292037'),
('5561307728'),
('5561337311'),
('5561341453'),
('5561374843'),
('5561393132'),
('5561393272'),
('5561422121'),
('5561422683'),
('5561432039'),
('5561440578'),
('5561450916'),
('5561454918'),
('5561475897'),
('5561530410'),
('5561562892'),
('5561580837'),
('5561590802'),
('5561604363'),
('5561612135'),
('5561642967'),
('5561652008'),
('5561666206'),
('5561668012'),
('5561689117'),
('5561719682'),
('5561721654'),
('5561740548'),
('5561741009'),
('5561757971'),
('5561763896'),
('5561772582'),
('5561789719'),
('5561822908'),
('5561831925'),
('5561833723'),
('5561837161'),
('5561854315'),
('5561875468'),
('5561875773'),
('5561880591'),
('5561882290'),
('5561895623'),
('5561897504'),
('5561899104'),
('5561934984'),
('5561948786'),
('5561951640'),
('5561953372'),
('5561953562'),
('5561976365'),
('5561994434'),
('5562002286'),
('5562008119'),
('5562014257'),
('5562014801'),
('5562025196'),
('5562025949'),
('5562028034'),
('5562035294'),
('5562036631'),
('5562037720'),
('5562039213'),
('5562040294'),
('5562048545'),
('5562049790'),
('5562055813'),
('5562056993'),
('5562060359'),
('5562061639'),
('5562072412'),
('5562075753'),
('5562081009'),
('5562083104'),
('5562085513'),
('5562086982'),
('5562092212'),
('5562106590'),
('5562110360'),
('5562111814'),
('5562147776'),
('5562155357'),
('5562158732'),
('5562159615'),
('5562175520'),
('5562186790'),
('5562195569'),
('5562208214'),
('5562211820'),
('5562214980'),
('5562226372'),
('5562230838'),
('5562238476'),
('5562241918'),
('5562243542'),
('5562253806'),
('5562254721'),
('5562266097'),
('5562274406'),
('5562281286'),
('5562285618'),
('5562309004'),
('5562317825'),
('5562335785'),
('5562340751'),
('5562359777'),
('5562390947'),
('5562392646'),
('5562412964'),
('5562424803'),
('5562430719'),
('5562430735'),
('5562430735'),
('5562431360'),
('5562446020'),
('5562446384'),
('5562452309'),
('5562459999'),
('5562463355'),
('5562465178'),
('5562478973'),
('5562481688'),
('5562498237'),
('5562499508'),
('5562508654'),
('5562513290'),
('5562514009'),
('5562548452'),
('5562567544'),
('5562570050'),
('5562594787'),
('5562596808'),
('5562596899'),
('5562624139'),
('5562632983'),
('5562647460'),
('5562653864'),
('5562655430'),
('5562670322'),
('5562678747'),
('5562694595'),
('5562697762'),
('5562734813'),
('5562737782'),
('5562777184'),
('5562797117'),
('5562801240'),
('5562804798'),
('5562817261'),
('5562821347'),
('5562833482'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562842905'),
('5562846112'),
('5562850643'),
('5562853829'),
('5562858083'),
('5562866284'),
('5562892751'),
('5562896802'),
('5562910116'),
('5562922368'),
('5562923705'),
('5562925353'),
('5562937606'),
('5562947340'),
('5562948710'),
('5562953041'),
('5562957968'),
('5562964196'),
('5562982420'),
('5562986256'),
('5562989524'),
('5562989656'),
('5562989755'),
('5562994243'),
('5563009181'),
('5563013035'),
('5563013555'),
('5563013696'),
('5563017242'),
('5563018919'),
('5563027126'),
('5563027761'),
('5563028645'),
('5563034270'),
('5563037950'),
('5563050797'),
('5563051423'),
('5563052033'),
('5563056059'),
('5563072841'),
('5563076032'),
('5563080653'),
('5563091080'),
('5563101319'),
('5563102317'),
('5563111896'),
('5563113363'),
('5563118750'),
('5563120194'),
('5563122992'),
('5563150142'),
('5563158780'),
('5563161099'),
('5563166064'),
('5563196921'),
('5563197820'),
('5563212793'),
('5563214492'),
('5563214500'),
('5563218659'),
('5563231546'),
('5563232601'),
('5563256758'),
('5563271633'),
('5563290260'),
('5563301778'),
('5563318012'),
('5563326825'),
('5563326882'),
('5563338952'),
('5563355766'),
('5563381432'),
('5563385318'),
('5563385458'),
('5563385508'),
('5563388981'),
('5563390813'),
('5563397230'),
('5563415297'),
('5563418812'),
('5563430189'),
('5563442838'),
('5563473122'),
('5563473569'),
('5563479251'),
('5563480085'),
('5563483790'),
('5563484194'),
('5563490225'),
('5563512374'),
('5563530566'),
('5563533081'),
('5563533446'),
('5563544955'),
('5563554434'),
('5563555688'),
('5563556777'),
('5563562437'),
('5563569358'),
('5563573517'),
('5563585180'),
('5563588333'),
('5563592061'),
('5563592327'),
('5563600658'),
('5563616019'),
('5563619294'),
('5563636785'),
('5563653970'),
('5563667475'),
('5563670230'),
('5563676526'),
('5563680585'),
('5563689255'),
('5563690311'),
('5563696631'),
('5563703916'),
('5563722460'),
('5563758720'),
('5563787042'),
('5563820751'),
('5563836815'),
('5563839025'),
('5563848406'),
('5563849149'),
('5563854255'),
('5563869378'),
('5563876324'),
('5563881860'),
('5563897486'),
('5563925097'),
('5563925303'),
('5563926038'),
('5563934818'),
('5563950236'),
('5563965820'),
('5563988269'),
('5564003316'),
('5564003456'),
('5564006939'),
('5564007200'),
('5564018827'),
('5564030426'),
('5564031374'),
('5564038791'),
('5564038833'),
('5564064698'),
('5564080629'),
('5564087376'),
('5564089349'),
('5564103280'),
('5564115565'),
('5564121118'),
('5564121654'),
('5564127446'),
('5564132438'),
('5564133584'),
('5564138062'),
('5564148251'),
('5564149390'),
('5564155520'),
('5564176930'),
('5564176930'),
('5564178365'),
('5564182185'),
('5564183597'),
('5564183597'),
('5564185295'),
('5564188869'),
('5564188885'),
('5564205861'),
('5564206729'),
('5564210911'),
('5564210911'),
('5564215217'),
('5564219482'),
('5564229010'),
('5564231552'),
('5564239258'),
('5564239365'),
('5564253341'),
('5564261914'),
('5564269461'),
('5564275708'),
('5564276730'),
('5564285806'),
('5564293172'),
('5564305489'),
('5564311941'),
('5564312469'),
('5564327129'),
('5564328580'),
('5564346012'),
('5564355575'),
('5564386703'),
('5564390556'),
('5564395001'),
('5564397015'),
('5564402971'),
('5564406725'),
('5564407194'),
('5564416112'),
('5564422755'),
('5564424231'),
('5564429701'),
('5564432200'),
('5564439684'),
('5564442324'),
('5564466067'),
('5564480662'),
('5564481397'),
('5564483369'),
('5564485661'),
('5564486180'),
('5564487543'),
('5564499464'),
('5564499696'),
('5564499944'),
('5564503711'),
('5564511037'),
('5564511268'),
('5564512407'),
('5564512738'),
('5564520442'),
('5564525177'),
('5564526514'),
('5564533486'),
('5564546413'),
('5564550084'),
('5564551561'),
('5564561669'),
('5564562477'),
('5564573110'),
('5564577350'),
('5564577350'),
('5564578663'),
('5564579604'),
('5564580867'),
('5564582475'),
('5564583465'),
('5564585528'),
('5564589751'),
('5564594264'),
('5564595675'),
('5564601812'),
('5564608809'),
('5564624749'),
('5564655156'),
('5564658762'),
('5564671641'),
('5564712965'),
('5564719106'),
('5564731015'),
('5564737566'),
('5564740982'),
('5564746450'),
('5564753977'),
('5564763026'),
('5564768652'),
('5564786811'),
('5564798055'),
('5564816832'),
('5564824067'),
('5564826187'),
('5564835063'),
('5564844354'),
('5564860822'),
('5564867793'),
('5564881216'),
('5564887965'),
('5564891157'),
('5564893781'),
('5564905130'),
('5564916509'),
('5564919297'),
('5564931151'),
('5564935574'),
('5564958758'),
('5564958949'),
('5564964624'),
('5564975679'),
('5564977170'),
('5564984788'),
('5564986338'),
('5564990678'),
('5564993763'),
('5565004362'),
('5565005310'),
('5565005971'),
('5565007761'),
('5565008553'),
('5565009916'),
('5565023404'),
('5565024089'),
('5565031852'),
('5565039715'),
('5565050837'),
('5565059473'),
('5565060307'),
('5565062907'),
('5565079844'),
('5565087649'),
('5565097135'),
('5565100228'),
('5565100871'),
('5565101309'),
('5565103701'),
('5565104196'),
('5565107389'),
('5565108650'),
('5565116398'),
('5565129839'),
('5565136883'),
('5565147112'),
('5565149670'),
('5565152998'),
('5565155487'),
('5565159737'),
('5565162467'),
('5565168142'),
('5565179552'),
('5565189122'),
('5565208740'),
('5565223939'),
('5565226411'),
('5565227526'),
('5565231445'),
('5565232070'),
('5565235032'),
('5565237509'),
('5565239414'),
('5565241386'),
('5565246914'),
('5565255873'),
('5565256657'),
('5565266169'),
('5565275616'),
('5565279303'),
('5565279592'),
('5565281093'),
('5565283883'),
('5565289138'),
('5565289138'),
('5565292041'),
('5565293650'),
('5565302832'),
('5565304028'),
('5565311478'),
('5565322624'),
('5565333902'),
('5565336897'),
('5565349007'),
('5565349007'),
('5565357489'),
('5565359774'),
('5565359907'),
('5565363990'),
('5565367454'),
('5565368494'),
('5565376133'),
('5565376604'),
('5565393138'),
('5565393211'),
('5565405296'),
('5565408290'),
('5565408571'),
('5565409983'),
('5565410213'),
('5565420147'),
('5565422341'),
('5565423786'),
('5565426672'),
('5565426946'),
('5565430799'),
('5565439816'),
('5565445599'),
('5565447462'),
('5565447975'),
('5565448668'),
('5565461729'),
('5565463717'),
('5565471025'),
('5565471215'),
('5565472346'),
('5565475034'),
('5565476255'),
('5565480497'),
('5565481784'),
('5565491064'),
('5565492088'),
('5565501540'),
('5565502399'),
('5565502969'),
('5565504171'),
('5565505681'),
('5565509774'),
('5565515573'),
('5565516134'),
('5565531364'),
('5565542452'),
('5565545927'),
('5565551651'),
('5565554010'),
('5565554325'),
('5565559084'),
('5565559381'),
('5565559522'),
('5565596359'),
('5565598819'),
('5565618104'),
('5565621827'),
('5565636304'),
('5565644308'),
('5565645305'),
('5565647228'),
('5565647772'),
('5565657060'),
('5565668422'),
('5565691895'),
('5565700472'),
('5565702148'),
('5565708236'),
('5565711362'),
('5565713301'),
('5565716171'),
('5565716445'),
('5565744231'),
('5565747663'),
('5565750238'),
('5565758876'),
('5565758959'),
('5565760245'),
('5565763660'),
('5565764601'),
('5565764734'),
('5565769196'),
('5565774493'),
('5565790986'),
('5565793105'),
('5565805248'),
('5565805297'),
('5565813820'),
('5565831616'),
('5565834420'),
('5565835021'),
('5565838983'),
('5565845277'),
('5565845889'),
('5565849980'),
('5565858221'),
('5565861456'),
('5565865887'),
('5565866356'),
('5565872891'),
('5565874772'),
('5565877445'),
('5565879706'),
('5565880266'),
('5565888608'),
('5565891412'),
('5565893251'),
('5565908976'),
('5565915427'),
('5565916524'),
('5565928784'),
('5565939211'),
('5565940912'),
('5565941423'),
('5565942595'),
('5565946273'),
('5565952768'),
('5565954806'),
('5565956249'),
('5565962130'),
('5565979050'),
('5565985487'),
('5565986634'),
('5565987848'),
('5565988622'),
('5565994166'),
('5565999249'),
('5566001698'),
('5566011531'),
('5566012638'),
('5566021514'),
('5566031125'),
('5566033097'),
('5566042734'),
('5566047550'),
('5566055926'),
('5566058037'),
('5566059647'),
('5566059738'),
('5566061635'),
('5566062393'),
('5566066055'),
('5566066873'),
('5566068283'),
('5566072137'),
('5566079561'),
('5566080445'),
('5566080783'),
('5566083027'),
('5566083035'),
('5566088810'),
('5566090303'),
('5566094313'),
('5566107982'),
('5566116223'),
('5566133830'),
('5566134424'),
('5566139357'),
('5566140876'),
('5566141056'),
('5566157979'),
('5566166590'),
('5566166731'),
('5566168687'),
('5566184544'),
('5566188925'),
('5566190244'),
('5566197116'),
('5566198924'),
('5566201546'),
('5566202544'),
('5566205885'),
('5566210075'),
('5566211164'),
('5566214721'),
('5566219985'),
('5566222286'),
('5566222286'),
('5566227889'),
('5566230149'),
('5566230933'),
('5566234760'),
('5566241195'),
('5566249271'),
('5566253661'),
('5566266051'),
('5566269089'),
('5566273420'),
('5566280128'),
('5566280417'),
('5566281647'),
('5566292446'),
('5566296082'),
('5566298583'),
('5566302369'),
('5566302724'),
('5566308887'),
('5566315189'),
('5566318134'),
('5566319355'),
('5566319645'),
('5566319983'),
('5566326186'),
('5566331046'),
('5566337654'),
('5566348594'),
('5566352026'),
('5566357132'),
('5566366323'),
('5566374533'),
('5566384953'),
('5566392022')


INSERT INTO #Temp1
(Orgnr)
VALUES

('5566395199'),
('5566398821'),
('5566412887'),
('5566414180'),
('5566415450'),
('5566418413'),
('5566421052'),
('5566426358'),
('5566427794'),
('5566444203'),
('5566448386'),
('5566449558'),
('5566452693'),
('5566453154'),
('5566457536'),
('5566462155'),
('5566464763'),
('5566472188'),
('5566473368'),
('5566475371'),
('5566486832'),
('5566489992'),
('5566494125'),
('5566497219'),
('5566501846'),
('556651____'),
('5566526132'),
('5566530159'),
('5566534896'),
('5566548201'),
('5566553086'),
('5566553839'),
('5566554167'),
('5566554811'),
('5566564570'),
('5566565783'),
('5566566575'),
('5566574918'),
('5566575303'),
('5566577499'),
('5566592332'),
('5566604624'),
('5566605910'),
('5566605910'),
('5566607973'),
('5566608773'),
('5566608781'),
('5566608781'),
('5566610779'),
('5566627237'),
('5566628540'),
('5566636261'),
('5566642103'),
('5566643481'),
('5566644042'),
('5566651203'),
('5566651252'),
('5566652532'),
('5566657002'),
('5566660873'),
('5566679444'),
('5566681531'),
('5566689823'),
('5566693205'),
('5566697610'),
('5566705694'),
('5566713763'),
('5566721071'),
('5566722707'),
('5566722871'),
('5566724067'),
('5566733258'),
('5566747829'),
('5566763420'),
('5566766480'),
('5566770201'),
('5566777040'),
('5566777545'),
('5566781463'),
('5566789797'),
('5566789946'),
('5566794557'),
('5566796107'),
('5566799101'),
('5566805320'),
('5566810619'),
('5566815584'),
('5566815667'),
('5566820030'),
('5566822044'),
('5566843321'),
('5566845292'),
('5566858964'),
('5566859012'),
('5566859475'),
('5566863345'),
('5566863394'),
('5566868138'),
('5566872080'),
('5566878285'),
('5566882923'),
('5566884317'),
('5566885983'),
('5566915483'),
('5566916788'),
('5566924568'),
('5566934245'),
('5566940721'),
('5566941489'),
('5566946777'),
('5566947510'),
('5566957097'),
('5566957592'),
('5566963061'),
('5566971668'),
('5566971734'),
('5566980271'),
('5566980271'),
('5566988373'),
('5566997309'),
('5567009146'),
('5567012207'),
('5567015432'),
('5567019996'),
('5567026173'),
('5567036974'),
('5567041891'),
('5567044796'),
('5567048342'),
('5567049324'),
('5567050165'),
('5567061915'),
('5567067763'),
('5567070098'),
('5567071468'),
('5567072284'),
('5567103337'),
('5567113310'),
('5567136022'),
('5567139067'),
('5567139067'),
('5567142244'),
('5567149470'),
('5567150353'),
('5567155014'),
('5567159958'),
('5567163240'),
('5567165542'),
('5567168496'),
('5567171185'),
('5567173553'),
('5567187181'),
('5567189476'),
('5567191605'),
('5567202790'),
('5567203871'),
('5567211767'),
('5567231682'),
('5567233852'),
('5567234421'),
('5567237176'),
('5567243935'),
('5567246243'),
('5567247993'),
('5567256325'),
('5567258321'),
('5567266811'),
('5567271712'),
('5567272629'),
('5567276208'),
('5567279269'),
('5567279368'),
('5567279459'),
('5567284756'),
('5567287098'),
('5567293690'),
('5567295067'),
('5567295257'),
('5567299853'),
('5567316327'),
('5567319602'),
('5567322176'),
('5567324040'),
('5567331698'),
('5567335384'),
('5567342752'),
('5567345847'),
('5567348569'),
('5567350755'),
('5567352397'),
('5567352405'),
('5567352488'),
('5567354310'),
('5567356000'),
('5567362008'),
('5567365035'),
('5567367718'),
('5567369276'),
('5567374110'),
('5567384200'),
('5567391858'),
('5567393032'),
('5567394134'),
('5567397558'),
('5567397970'),
('5567401822'),
('5567404651'),
('5567410310'),
('5567416416'),
('5567422729'),
('5567440077'),
('5567441851'),
('5567442677'),
('5567449029'),
('5567452924'),
('5567454300'),
('5567456834'),
('5567461586'),
('5567466502'),
('5567469001'),
('5567469001'),
('5567475883'),
('5567484232'),
('5567486963'),
('5567492680'),
('5567494397'),
('5567497036'),
('5567503312'),
('5567515191'),
('5567515738'),
('5567526891'),
('5567527469'),
('5567553085'),
('5567559249'),
('5567577373'),
('5567580724'),
('5567584189'),
('5567605513'),
('5567607600'),
('5567623573'),
('5567633275'),
('5567652085'),
('5567670517'),
('5567672703'),
('5567674451'),
('5567675623'),
('5567681076'),
('5567707335'),
('5567712202'),
('5567715155'),
('5567722789'),
('5567732291'),
('5567732796'),
('5567732994'),
('5567733166'),
('5567733885'),
('5567743355'),
('5567745566'),
('5567768477'),
('5567769038'),
('5567771919'),
('5567773634'),
('5567775837'),
('5567779888'),
('5567781728'),
('5567786131'),
('5567800627'),
('5567808224'),
('5567812804'),
('5567826366'),
('5567826366'),
('5567826366'),
('5567829071'),
('5567829923'),
('5567835722'),
('5567842058'),
('5567863963'),
('5567864102'),
('5567864698'),
('5567873681'),
('5567873962'),
('5567874317'),
('5567879035'),
('5567879928'),
('5567880348'),
('5567881767'),
('5567888937'),
('5567903462'),
('5567927230'),
('5567928048'),
('5567930069'),
('5567937379'),
('5567941116'),
('5567946263'),
('5567946305'),
('5567947378'),
('5567964639'),
('5567965362'),
('5567968267'),
('5567969158'),
('5567974869'),
('5567975908'),
('5567976625'),
('5567987978'),
('5567991814'),
('5568002959'),
('5568009210'),
('5568012784'),
('5568016074'),
('5568016124'),
('5568032584'),
('5568035488'),
('5568040439'),
('5568041809'),
('5568050487'),
('5568051618'),
('5568052160'),
('5568053192'),
('5568062037'),
('5568065667'),
('5568071012'),
('5568073059'),
('5568073125'),
('5568085996'),
('5568089246'),
('5568089444'),
('5568112063'),
('5568123508'),
('5568141666'),
('5568145758'),
('5568149396'),
('5568149842'),
('5568149867'),
('5568155484'),
('5568161219'),
('5568162415'),
('5568163264'),
('5568163447'),
('5568164635'),
('5568169204'),
('5568173974'),
('5568176589'),
('5568178718'),
('5568186067'),
('5568189764'),
('5568196009'),
('5568208945'),
('5568209968'),
('5568215981'),
('5568219405'),
('5568222920'),
('5568241763'),
('5568251879'),
('5568254949'),
('5568262058'),
('5568272263'),
('5568272503'),
('5568300957'),
('5568313406'),
('5568329295'),
('5568330731'),
('5568347115'),
('5568351745'),
('5568368574'),
('5568372949'),
('5568378870'),
('5568385370'),
('5568398357'),
('5568428493'),
('5568434392'),
('5568435324'),
('5568436553'),
('5568439664'),
('5568444532'),
('5568449028'),
('5568463490'),
('5568464662'),
('5568468598'),
('5568482052'),
('5568500929'),
('5568500937'),
('5568507684'),
('5568510712'),
('5568518954'),
('5568519267'),
('5568534431'),
('5568547185'),
('5568549165'),
('5568559776'),
('5568567308'),
('5568578206'),
('5568589955'),
('5568600794'),
('5568608102'),
('5568614282'),
('5568620008'),
('5568620586'),
('5568623648'),
('5568640360'),
('5568642853'),
('5568642861'),
('5568644842'),
('5568658552'),
('5568658974'),
('5568688898'),
('5568690639'),
('5568692908'),
('5568699143'),
('5568702459'),
('5568703465'),
('5568714454'),
('5568721921'),
('5568731979'),
('5568737018'),
('5568737018'),
('5568737323'),
('5568738867'),
('5568739915'),
('5568744378'),
('5568748288'),
('5568750854'),
('5568756034'),
('5568760416'),
('5568787799'),
('5568796576'),
('5568812696'),
('5568822653'),
('5568836935'),
('5568837529'),
('5568842222'),
('5568848328'),
('5568852254'),
('5568874753'),
('5568875974'),
('5568889942'),
('5568895956'),
('5568896491'),
('5568938723'),
('5568945553'),
('5568948854'),
('5568950140'),
('5568953359'),
('5568971773'),
('5568980477'),
('5568991409'),
('5569018640'),
('5569029985'),
('5569038937'),
('5569057143'),
('5569057531'),
('5569058810'),
('5569060360'),
('5569065476'),
('5569067530'),
('5569068389'),
('5569069833'),
('5569071136'),
('5569079576'),
('5569083917'),
('5569090888'),
('5569098527'),
('5569101503'),
('5569110348'),
('5569114852'),
('5569116154'),
('5569127292'),
('5569129751'),
('5569136350'),
('5569141095'),
('5569143984'),
('5569156341'),
('5569167355'),
('5569185027'),
('5569185233'),
('5569186025'),
('5569196958'),
('5569197451'),
('5569204448'),
('5569208639'),
('5569216707'),
('5569238982'),
('5569243479'),
('5569251852'),
('5569259442'),
('5569282774'),
('5569282774'),
('5569294910'),
('5569295818'),
('5569298655'),
('5569299653'),
('5569302606'),
('5569313256'),
('5569315202'),
('5569325847'),
('5569327363'),
('5569331894'),
('5569335283'),
('5569347536'),
('5569353674'),
('5569363988'),
('5569366692'),
('5569369175'),
('5569382806'),
('5569390825'),
('5569391187'),
('5569391609'),
('5569398513'),
('5569401333'),
('5569416182'),
('5569432957'),
('5569456600'),
('5569457814'),
('5569464059'),
('5569481368'),
('5569483620'),
('5569490484'),
('5569490682'),
('5569493991'),
('5569495590'),
('5569501769'),
('5569516643'),
('5569521783'),
('5569521965'),
('5569532590'),
('5569554693'),
('5569587438'),
('5569601312'),
('5569604886'),
('5569617888'),
('5569618019'),
('5569634966'),
('5569639338'),
('5569640369'),
('5569654063'),
('5569656761'),
('5569673386'),
('5569704637'),
('5569705907'),
('5569716888'),
('5569719593'),
('5569725335'),
('5569727109'),
('5569730459'),
('5569752206'),
('5569759615'),
('5569764078'),
('5569765331'),
('5569767261'),
('5569770398'),
('5569788358'),
('5569790982'),
('5569792905'),
('5569795288'),
('5569806044'),
('5569808362'),
('5569823908'),
('5569832594'),
('5569835613'),
('5569841918'),
('5569863847'),
('5569874463'),
('5569880387'),
('5569885683'),
('5569912024'),
('5569931289'),
('5569936197'),
('5569936809'),
('5569937120'),
('5569938151'),
('5569942658'),
('5569968968'),
('5569972317'),
('5569973539'),
('5569994956'),
('5569998841'),
('5577437436'),
('5590012240'),
('5590012539'),
('5590014568'),
('5590028808'),
('5590031497'),
('5590032404'),
('5590038559'),
('5590061858'),
('5590070370'),
('5590084462'),
('5590085154'),
('5590085295'),
('5590085303'),
('5590109814'),
('5590123435'),
('5590124417'),
('5590129028'),
('5590130448')


INSERT INTO #Temp1
(Orgnr)
VALUES

('5590152640'),
('5590156898'),
('5590166723'),
('5590167861'),
('5590189022'),
('5590190749'),
('5590197124'),
('5590197405'),
('5590205075'),
('5590217096'),
('5590225636'),
('5590246079'),
('5590258017'),
('5590262902'),
('5590288899'),
('5590295043'),
('5590327960'),
('5590331772'),
('5590354592'),
('5590354824'),
('5590375431'),
('5590420252'),
('5590423645'),
('5590444013'),
('5590448675'),
('5590453329'),
('5590460985'),
('5590463807'),
('5590463856'),
('5590497193'),
('5590519467'),
('5590519913'),
('5590534490'),
('5590534961'),
('5590559406'),
('5590575535'),
('5590592837'),
('5590598222'),
('5590600119'),
('5590602933'),
('5590627534'),
('5590639430'),
('5590669510'),
('5590676911'),
('5590698774'),
('5590699269'),
('5590702709'),
('5590705306'),
('5590729058'),
('5590732359'),
('5590750245'),
('5590750633'),
('5590758511'),
('5590759469'),
('5590765680'),
('5590779749'),
('5590804794'),
('5590817358'),
('5590834650'),
('5590835129'),
('5590840434'),
('5590857065'),
('5590868039'),
('5590868435'),
('5590873708'),
('5590873708'),
('5590879911'),
('5590895438'),
('5590906847'),
('5590911219'),
('5590911714'),
('5590912613'),
('5590913165'),
('5590929682'),
('5590933361'),
('5590949284'),
('5590956172'),
('5590960661'),
('5590966684'),
('5590984083'),
('5590984422'),
('5590995337'),
('5591004378'),
('5591004816'),
('5591024228'),
('5591039986'),
('5591041420'),
('5591045827'),
('5591060495'),
('5591073274'),
('5591073316'),
('5591104418'),
('5591112536'),
('5591120067'),
('5591129001'),
('5591133011'),
('5591141642'),
('5591145577'),
('5591155881'),
('5591161228'),
('5591166938'),
('5591175913'),
('5591175913'),
('5591178396'),
('5591181200'),
('5591181622'),
('5591188429'),
('5591191258'),
('5591209639'),
('5591212682'),
('5591214258'),
('5591220677'),
('5591221485'),
('5591221568'),
('5591231781'),
('5591241608'),
('5591246409'),
('5591257661'),
('5591274864'),
('5591277032'),
('5591290175'),
('5591315865'),
('5591320717'),
('5591326789'),
('5591332449'),
('5591332522'),
('5591337042'),
('5591347538'),
('5591352264'),
('5591354112'),
('5591371769'),
('5591378319'),
('5591380455'),
('5591384192'),
('5591399224'),
('5591406383'),
('5591419626'),
('5591422042'),
('5591427538'),
('5591430144'),
('5591434500'),
('5591450209'),
('5591464689'),
('5591471437'),
('5591475826'),
('5591479620'),
('5591496889'),
('5591525240'),
('5591526859'),
('5591531263'),
('5591568489'),
('5591569305'),
('5591575906'),
('5591583629'),
('5591584106'),
('5591588289'),
('5591588867'),
('5591590525'),
('5591591739'),
('5591605091'),
('5591609309'),
('5591609325'),
('5591615744'),
('5591623268'),
('5591625693'),
('5591627814'),
('5591628325'),
('5591629778'),
('5591630735'),
('5591630750'),
('5591631881'),
('5591639934'),
('5591646806'),
('5591647416'),
('5591655518'),
('5591658041'),
('5591660997'),
('5591661235'),
('5591663199'),
('5591665285'),
('5591672851'),
('5591683718'),
('5591689285'),
('5591699771'),
('5591705313'),
('5591714042'),
('5591716039'),
('5591719629'),
('5591720015'),
('5591737761'),
('5591746333'),
('5591748289'),
('5591749899'),
('5591755078'),
('5591764765'),
('5591771281'),
('5591776249'),
('5591783625'),
('5591787808'),
('5591792386'),
('5591816607'),
('5591818066'),
('5591829808'),
('5591840508'),
('5591849004'),
('5591878540'),
('5591882336'),
('5591885610'),
('5591901656'),
('5591916738'),
('5591916761'),
('5591921860'),
('5603291013'),
('5707160072'),
('5712165553'),
('5808220197'),
('5903141652'),
('5907026925'),
('6008061076'),
('6009191617'),
('6101291927'),
('6103035520'),
('6104030041'),
('6108073989'),
('6110130306'),
('6208212891'),
('6209047122'),
('6212040221'),
('6262626262'),
('6306281210'),
('6308138210'),
('6310121055'),
('6311023219'),
('6403027813'),
('6403036996'),
('6403179416'),
('6405081909'),
('6408299086'),
('6409130256'),
('6410181074'),
('6502073312'),
('6502101196'),
('6603261147'),
('6604050259'),
('6604168549'),
('6607190193'),
('6612211059'),
('6704251096'),
('6709203944'),
('6711283330'),
('6712151049'),
('6805030134'),
('6809277202'),
('6812030242'),
('6901290541'),
('6903040753'),
('6906027617'),
('6906190050'),
('6906294878'),
('7002121650'),
('7011120180'),
('7012122953'),
('7105060334'),
('7107171451'),
('7164201423'),
('7164547593'),
('7176007990'),
('7205190387'),
('7206107539'),
('7208093224'),
('7301070277'),
('7306030136'),
('7306170510'),
('7403140754'),
('7410159268'),
('7502110542'),
('7502203230'),
('7572008121'),
('7602227816'),
('7603310611'),
('7605195606'),
('7609130799'),
('7611220349'),
('7696001275'),
('7696018279'),
('7696031009'),
('7696144539'),
('7696196240'),
('7696201248'),
('7709221449'),
('8020034792'),
('8020047240'),
('8020049725'),
('8020068196'),
('8020084094'),
('8020120963'),
('8020178060'),
('8024000716'),
('8024098264'),
('8024101936'),
('8024104096'),
('8024144324'),
('8024249933'),
('8024801576'),
('8111200195'),
('8136001719'),
('8144011783'),
('8156001474'),
('8201288241'),
('8207090518'),
('8209110298'),
('8306103279'),
('8340009094'),
('8350001601'),
('8394005394'),
('8411140174'),
('8501318953'),
('8505153984'),
('8572100017'),
('8609160554'),
('8650005682'),
('8704040396'),
('8740019214'),
('8805017152'),
('8844005960'),
('8888888888'),
('8932000303'),
('9010024678'),
('9165067001'),
('9165091852'),
('9165561516'),
('9165605073'),
('9165806986'),
('9166131731'),
('9166184714'),
('9166243288'),
('9166251828'),
('9166370701'),
('9167744128'),
('9168978139'),
('9169126514'),
('9169412740'),
('9240003781'),
('9572008887'),
('9696218701'),
('9696237156'),
('9696417386'),
('9696612879'),
('9696672121'),
('9696705715'),
('9696773036'),
('9696901355'),
('9696935148'),
('9696951723'),
('9697059807'),
('9697169408'),
('9697779263')


CREATE TABLE #Temp2
(
 Orgnr CHAR(10)
)


INSERT INTO #Temp2 (Orgnr)
select distinct kf.Orgnr
from dw.Kundforetag kf
where kf.Aktiv = 'j'
-- Plocka bort IBM, som inte längre är vår kund
and kf.Orgnr != '5560266883'
-- Vi bör ha fått någon form av ersättning från företaget
and (exists (select 1 from dw.Prov_Provision p where p.Period  between '2018-01' and '2018-12' and p.ForsakringstagareOrgnr = kf.Orgnr) or
exists (select 1 from dw.Arvode ar where ar.Period between '2018-01' and '2018-12' and ar.Orgnr = kf.Orgnr));

CREATE TABLE #Temp3
(
 Orgnr CHAR(10)
)

INSERT INTO #Temp3 (Orgnr)
SELECT t1.Orgnr FROM #Temp1 t1
JOIN #Temp2 t2 ON t1.Orgnr = t2.Orgnr

CREATE TABLE #Temp4
(
 Orgnr CHAR(10),
 Belopp INT
)

INSERT INTO #Temp4 (Orgnr, Belopp)
SELECT alpha.Orgnr, beta.Belopp FROM
(
	SELECT DISTINCT kf.Orgnr
	FROM dw.Kundforetag kf
	WHERE kf.Aktiv = 'j'
	-- Plocka bort IBM, som inte längre är vår kund
	and kf.Orgnr != '5560266883'
	-- Vi bör ha fått någon form av ersättning från företaget
	AND (EXISTS (SELECT 1 FROM dw.Prov_Provision p WHERE p.Period  between '2018-01' and '2018-12' and p.ForsakringstagareOrgnr = kf.Orgnr) OR
	EXISTS (SELECT 1 FROM dw.Arvode ar WHERE ar.Period between '2018-01' and '2018-12' and ar.Orgnr = kf.Orgnr))) alpha
LEFT JOIN
	(SELECT Orgnr, SUM(Belopp) AS Belopp FROM
	  (
		SELECT ForsakringstagareOrgnr AS Orgnr, SUM(ProvisionBrutto) AS Belopp
		FROM dw.Prov_Provision
		WHERE Period >= '2018-01'
		AND Period <= '2018-12'
		AND Produktgrupp != 'Sakförsäkring'
		GROUP BY ForsakringstagareOrgnr
	UNION ALL
		SELECT Orgnr, SUM(Belopp) AS Belopp
		FROM dw.Arvode
		WHERE Period >= '2018-01'
		AND Period <= '2018-12'
		GROUP BY Orgnr
	  ) totals
		WHERE Belopp > 0
		GROUP BY Orgnr) beta
ON alpha.Orgnr = beta.Orgnr
ORDER BY beta.Belopp DESC


CREATE TABLE #Temp5
(
 Orgnr CHAR(10),
 Belopp INT
)

INSERT INTO #Temp5 (Orgnr, Belopp)
SELECT t4.Orgnr, t4.Belopp FROM #Temp4 t4
JOIN #Temp3 t3 ON t4.Orgnr = t3.Orgnr
ORDER BY Belopp DESC


DROP TABLE #Temp1
DROP TABLE #Temp2
DROP TABLE #Temp3
DROP TABLE #Temp4
DROP TABLE #Temp5


        --MMAB
        SELECT DISTINCT BolagID, t.Orgnr, t.Belopp
        FROM #Temp5 t, dw.Prov_Provision pp
        WHERE t.Orgnr = pp.ForsakringstagareOrgnr
        AND BolagID = '1'
        ORDER BY t.Belopp DESC
        
        --MMVP
        SELECT DISTINCT BolagID, t.Orgnr, t.Belopp
        FROM #Temp5 t, dw.Prov_Provision pp
        WHERE t.Orgnr = pp.ForsakringstagareOrgnr
        AND BolagID = '2'
ORDER BY t.Belopp DESC
